{% load staticfiles i18n %}
<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
         <title>{% block title %} LECTORDECB {% endblock title %} </title>
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/material-design-iconic-font/dist/css/material-design-iconic-font.min.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/animate.css/animate.min.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/jquery.scrollbar/jquery.scrollbar.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/select2/dist/css/select2.min.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/dropzone/dist/dropzone.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/flatpickr/dist/flatpickr.min.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/nouislider/distribute/nouislider.min.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/bootstrap-colorpicker/dist/css/bootstrap-colorpicker.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/vendors/bower_components/trumbowyg/dist/ui/trumbowyg.min.css' %}">
        <link rel="shortcut icon" href="{% static 'zaresapp/lectordecb/img/favicon.png' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/css/app.min.css' %}">
        <link rel="stylesheet" href="{% static 'zaresapp/lectordecb/css/font-awesome.min.css' %}">
    </head>
    <style>
        #data-table_length{
            padding-left: 15px;
        }
        @media (min-width: 576px){
            .content--full {
                padding: 60px 30px 0;
            }
        }
        .search__helper {
            color:white;
        }
        .search {
            margin-right: 0px;
        }
        .alert-info {
            background-color: rgb(243, 243, 243);
            border-color: #2495f3;
            color: #676767;
        }
        .paginate_button.current {
            background-color: #2495f3;
        }    
    </style>
    <body data-ma-theme="blue">
        <main class="main main--alt">
            <div class="page-loader">
                <div class="page-loader__spinner">
                    <svg viewBox="25 25 50 50">
                        <circle cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" />
                    </svg>
                </div>
            </div>
            <header class="header">
                <div class="navigation-trigger hidden-xl-up" data-ma-action="aside-open" data-ma-target=".sidebar">
                    <div class="navigation-trigger__inner">
                        <i class="navigation-trigger__line"></i>
                        <i class="navigation-trigger__line"></i>
                        <i class="navigation-trigger__line"></i>
                    </div>
                </div>
                <div class="header__logo hidden-sm-down">
                    <h1><a href="/">{{request.user.visible_username|upper}}</a></h1>
                </div>
                <ul class="top-nav">
                    <li class=""><a href="{%url 'user_logout'%}"> <i class="fa fa-sign-out" aria-hidden="true"></i> Salir</a></li>
                </ul>
            </header>
            <section class="content content--full">
                {%if message %}
                    <div class="alert alert-info alert-dismissible fade show">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                        {{message}}
                    </div>
                {%endif%}
                {%if empleado%}
                    {%if not message%}
                        <header class="content__title">
                            <h1 style="font-size: 25px;">LISTADO DE TICKETS POR EMPLEADO Y CORTE</h1>
                        </header>
                        <div class="card bc-white" style="box-shadow: 0 0px 0px rgba(0, 0, 0, 0.075);">
                            <div class="row no-gutters align-items-center" style="background-color: #f3f3f3;">
                                <div class="col-10 bc-blue" style="background-color:rgb(36, 149, 243);">
                                    <form id="search" action="/" method="get" enctype="multipart/form-data" class="search">
                                        <div class="search__inner">
                                            <input type="text" class="search__text" placeholder="BUSCAR TICKETS CON ID DE EMPLEADO EN CORTE 0-00{{corte.id}}" name="empleado">
                                            <i class="zmdi zmdi-search search__helper" data-ma-action="search-close"></i>
                                        </div>
                                        <input type="hidden" class="" name="corte" value="{{corte.id}}">
                                    </form>
                                </div>
                                <div class="col bc-white" style="background-color: rgb(243, 243, 243)">
                                    <a href="/?corte={{corte.id}}" class="btn btn-blue btn-lg waves-effect float-right" style="box-shadow: 0 2px 2px 0 rgb(36, 149, 243);background-color: #2495f3;color:#fff">REGRESAR AL CORTE</a>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-block">
                                <h2 class="card-title"><small>CORTE</small> 0-00{{corte.id}}</h2>
                                <h2 class="card-title"><small>EMPLEADO</small> {{empleado}}</h2>
                                <h2 class="card-title">{{empleadoq.0.PRVCOD}} - <small>{{empleadoq.0.PRVNOM}}</small></h2>
                                <h2 class="card-title"><small>TOTAL:</small> {{total}}</h2>
                                <div class="table-responsive">
                                    <table id="data-table" class="table table-bordered">
                                        <thead class="thead-default">
                                            <tr>
                                                <th>FOLIO</th>
                                                <th>FECHA CAPTURA</th>
                                                <th>CANTIDAD</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {%for ticket in tickets%}
                                                <tr>
                                                    <th>{{ticket.TKTSEQ}}</th>
                                                    <th>{{ticket.TKTDATEEND2}}</th>
                                                    <th>{{ticket.TKTSURT}}</th>
                                                </tr>
                                            {%endfor%}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    {%else%}
                        <div class="card bc-white" style="box-shadow: 0 0px 0px rgba(0, 0, 0, 0.075);">
                            <div class="row no-gutters align-items-center" style="background-color: #f3f3f3;">
                                <div class="col-10 bc-blue" style="background-color:rgb(36, 149, 243);">
                                    <form id="search" action="/" method="get" enctype="multipart/form-data" class="search">
                                        <div class="search__inner">
                                            <input type="text" class="search__text" placeholder="BUSCAR TICKETS CON ID DE EMPLEADO EN CORTE 0-00{{corte.id}}" name="empleado">
                                            <i class="zmdi zmdi-search search__helper" data-ma-action="search-close"></i>
                                        </div>
                                        <input type="hidden" class="" name="corte" value="{{corte.id}}">
                                    </form>
                                </div>
                                <div class="col bc-white" style="background-color: rgb(243, 243, 243)">
                                    <a href="/?corte={{corte.id}}" class="btn btn-blue btn-lg waves-effect float-right" style="box-shadow: 0 2px 2px 0 rgb(36, 149, 243);background-color: #2495f3;color:#fff">REGRESAR AL CORTE</a>
                                </div>
                            </div>
                        </div>
                    {%endif%}
                {%elif corte%}
                    <header class="content__title">
                        <h1 style="font-size: 25px;">LISTADO DE TICKETS</h1>
                    </header>
                    <div class="card bc-white">
                        <div class="row no-gutters align-items-center">
                            <div class="col-12 bc-blue" style="background-color: rgb(36, 149, 243);">
                                <form id="search" action="/" method="get" enctype="multipart/form-data" class="search">
                                    <div class="search__inner">
                                        <input type="text" class="search__text" placeholder="BUSCAR TICKETS CON ID DE EMPLEADO EN CORTE 0-00{{corte.id}}" name="empleado">
                                        <i class="zmdi zmdi-search search__helper" data-ma-action="search-close"></i>
                                    </div>
                                    <input type="hidden" class="" name="corte" value="{{corte.id}}">
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-block">
                            <h2 class="card-title">CORTE 0-00{{corte.id}}</h2>
                            <div class="table-responsive">
                                <table id="data-table" class="table table-bordered">
                                    <thead class="thead-default">
                                        <tr>
                                            <th>FOLIO</th>
                                            <th>EMPLEADO</th>
                                            <th>FECHA CAPTURA</th>
                                            <th>CANTIDAD</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {%for ticket in tickets%}
                                            <tr>
                                                <th>{{ticket.TKTSEQ}}</th>
                                                <th>{{ticket.TKTEMPL}}</th>
                                                <th>{{ticket.TKTDATEEND2}}</th>
                                                <th>{{ticket.TKTSURT}}</th>
                                            </tr>
                                        {%endfor%}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                {%else%}
                    <header class="content__title">
                        <h1 style="font-size: 25px;">SISTEMA DE REPORTES</h1>
                    </header>
                    <div class="card">
                        <div class="card-block">
                            <h2 class="card-title">CORTE ACTUAL 0-00{{corte_actual.id}}</h2>
                            <div class="table-responsive">
                                <table id="data-table" class="table table-bordered">
                                    <thead class="thead-default">
                                        <tr>
                                            <th>ID</th>
                                            <th>FECHA INICIO</th>
                                            <th>FECHA FIN</th>
                                            <th>USUARIO</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {%for cor in cortes%}
                                            <tr>
                                                <th><a href="/?corte={{cor.id}}" style="color:inherit;"><strong>0-00{{cor.id}}</strong></a></th>
                                                <th><a href="/?corte={{cor.id}}" style="color:inherit;">{{cor.fecha_inicio}}</a></th>
                                                <th><a href="/?corte={{cor.id}}" style="color:inherit;">{%if cor.fecha_corte%}{{cor.fecha_corte}}{%else%}-{%endif%}</a></th>
                                                <th>{%if cor.usuario%}{{cor.usuario}}{%else%}<a href="/?hacer_corte={{cor.id}}" class="btn btn-primary btn-sm waves-effect">HACER CORTE</a>{%endif%}</th>
                                            </tr>
                                        {%endfor%}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                {%endif%}
                <footer class="footer">
                    <p>© Powered by ZaresDelWeb.</p>
                </footer>
            </section>
        </main>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/jquery/dist/jquery.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/tether/dist/js/tether.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/bootstrap/dist/js/bootstrap.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/Waves/dist/waves.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/jquery.scrollbar/jquery.scrollbar.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/jquery-scrollLock/jquery-scrollLock.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/datatables.net/js/jquery.dataTables.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/datatables.net-buttons/js/dataTables.buttons.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/datatables.net-buttons/js/buttons.print.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/jszip/dist/jszip.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/datatables.net-buttons/js/buttons.html5.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/jquery-mask-plugin/dist/jquery.mask.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/select2/dist/js/select2.full.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/dropzone/dist/min/dropzone.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/moment/min/moment.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/flatpickr/dist/flatpickr.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/nouislider/distribute/nouislider.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/bootstrap-colorpicker/dist/js/bootstrap-colorpicker.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/vendors/bower_components/trumbowyg/dist/trumbowyg.min.js' %}"></script>
        <script src="{% static 'zaresapp/lectordecb/js/app.min.js' %}"></script>
        <script type="text/javascript" charset="utf-8" async defer>
            data_table = $("#data-table").DataTable({
                autoWidth: !1,
                ordering: false,
                responsive: !0,
                lengthMenu: [
                    [30, 50, 100],
                    ["30 filas", "50 filas", "100 filas"]
                ],
                language: {
                    "searchPlaceholder": "Buscar...",
                    "sProcessing":     "Procesando...",
                    "sLengthMenu":     "Mostrar _MENU_ registros",
                    "sZeroRecords":    "No se encontraron resultados",
                    "sEmptyTable":     "Ningún dato disponible en esta tabla",
                    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0 registros",
                    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
                    "sInfoPostFix":    "",
                    "sSearch":         "Buscar:",
                    "sUrl":            "",
                    "sInfoThousands":  ",",
                    "sLoadingRecords": "Cargando...",
                    "oPaginate": {
                        "sFirst":    "Primero",
                        "sLast":     "Último",
                        "sNext":     "Siguiente",
                        "sPrevious": "Anterior"
                    },
                    "oAria": {
                        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
                        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                    }
                },
                dom: "Blfrtip",
                buttons: [{ extend: "excelHtml5", title: "Export Data" }, { extend: "csvHtml5", title: "Export Data" }, { extend: "print", title: "Material Admin" }],
                initComplete: function(a, b) { $(this).closest(".dataTables_wrapper").prepend(
                    '<div class="dataTables_buttons hidden-sm-down actions"><span class="actions__item zmdi zmdi-print" data-table-action="print" /><span class="actions__item zmdi zmdi-fullscreen" data-table-action="fullscreen" /><div class="dropdown actions__item"><i data-toggle="dropdown" class="zmdi zmdi-download" /><ul class="dropdown-menu dropdown-menu-right"><a href="" class="dropdown-item" data-table-action="excel">Excel (.xlsx)</a><a href="" class="dropdown-item" data-table-action="csv">CSV (.csv)</a></ul></div></div>'
                    )}
                }), $(".dataTables_filter input[type=search]").focus(function() { $(this).closest(".dataTables_filter").addClass("dataTables_filter--toggled") }), $(".dataTables_filter input[type=search]").blur(function() { $(this).closest(".dataTables_filter").removeClass("dataTables_filter--toggled") }), $("body").on("click", "[data-table-action]", function(a) {
                a.preventDefault();
                var b = $(this).data("table-action");
                if ("excel" === b && $(this).closest(".dataTables_wrapper").find(".buttons-excel").trigger("click"), "csv" === b && $(this).closest(".dataTables_wrapper").find(".buttons-csv").trigger("click"), "print" === b && $(this).closest(".dataTables_wrapper").find(".buttons-print").trigger("click"), "fullscreen" === b) {
                    var c = $(this).closest(".card");
                    c.hasClass("card--fullscreen") ? (c.removeClass("card--fullscreen"), $("body").removeClass("data-table-toggled")) : (c.addClass("card--fullscreen"), $("body").addClass("data-table-toggled"))
                }
            })
        </script>
    </body>
</html>